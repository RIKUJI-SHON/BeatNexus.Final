# å¤šè¨€èªåŒ–å¯¾å¿œå®Ÿè£…ãƒ­ã‚°

**å®Ÿè£…æ—¥**: 2025å¹´7æœˆ25æ—¥
**æ©Ÿèƒ½**: æŠ•ç¨¿åˆ¶é™é–¢æ•°ã®å¤šè¨€èªåŒ–å¯¾å¿œ

## ğŸ“‹ å®Ÿè£…æ¦‚è¦

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢æ•°å†…ã§ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãŸæ—¥æœ¬èªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤šè¨€èªå¯¾å¿œã«å¤‰æ›´ã—ã¾ã—ãŸã€‚
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢æ•°ã§ã¯ç¿»è¨³ã‚­ãƒ¼ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿”ã—ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã§ç¿»è¨³ã™ã‚‹ä»•çµ„ã¿ã«å¤‰æ›´ã€‚

## ğŸ”„ å¤‰æ›´å†…å®¹

### 1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢æ•°ã®å¤‰æ›´

#### check_submission_cooldowné–¢æ•°
**å¤‰æ›´å‰**:
```sql
v_message := 'æŠ•ç¨¿å¯èƒ½ã§ã™';
v_message := '1æ™‚é–“ä»¥å†…ã«æŠ•ç¨¿ã§ãã‚‹ã®ã¯1æœ¬ã¾ã§ã§ã™ã€‚æ®‹ã‚Šæ™‚é–“: ' || ...;
```

**å¤‰æ›´å¾Œ**:
```sql
'message_key', 'submission.cooldown.canSubmit'
'message_key', 'submission.cooldown.restriction'
'message_params', json_build_object('hours', ..., 'minutes', ...)
```

#### create_submission_with_cooldown_checké–¢æ•°
**å¤‰æ›´å‰**:
```sql
'message', 'ã‚·ãƒ¼ã‚ºãƒ³åˆ¶é™ã«ã‚ˆã‚ŠæŠ•ç¨¿ã§ãã¾ã›ã‚“ã€‚'
'message', '1æ™‚é–“ä»¥å†…ã«æŠ•ç¨¿ã§ãã‚‹ã®ã¯1æœ¬ã¾ã§ã§ã™ã€‚æ¬¡å›æŠ•ç¨¿å¯èƒ½ã¾ã§: ...'
```

**å¤‰æ›´å¾Œ**:
```sql
'message_key', 'submission.error.seasonRestriction'
'message_key', 'submission.error.cooldownActive'
'message_params', json_build_object('hours', ..., 'minutes', ...)
```

### 2. ç¿»è¨³ãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ 

#### æ—¥æœ¬èª (ja.json)
```json
"submission": {
  "cooldown": {
    "canSubmit": "æŠ•ç¨¿å¯èƒ½ã§ã™",
    "restriction": "1æ™‚é–“ä»¥å†…ã«æŠ•ç¨¿ã§ãã‚‹ã®ã¯1æœ¬ã¾ã§ã§ã™ã€‚æ®‹ã‚Šæ™‚é–“: {{hours}}æ™‚é–“{{minutes}}åˆ†",
    "error": "ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ãƒã‚§ãƒƒã‚¯ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {{error}}"
  },
  "success": {
    "created": "æŠ•ç¨¿ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚"
  },
  "error": {
    "seasonRestriction": "ã‚·ãƒ¼ã‚ºãƒ³åˆ¶é™ã«ã‚ˆã‚ŠæŠ•ç¨¿ã§ãã¾ã›ã‚“ã€‚",
    "cooldownActive": "1æ™‚é–“ä»¥å†…ã«æŠ•ç¨¿ã§ãã‚‹ã®ã¯1æœ¬ã¾ã§ã§ã™ã€‚æ¬¡å›æŠ•ç¨¿å¯èƒ½ã¾ã§: {{hours}}æ™‚é–“{{minutes}}åˆ†",
    "creationFailed": "æŠ•ç¨¿ä½œæˆä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {{error}}"
  }
}
```

#### è‹±èª (en.json)
```json
"submission": {
  "cooldown": {
    "canSubmit": "Submission available",
    "restriction": "You can only submit one video per hour. Time remaining: {{hours}}h {{minutes}}m",
    "error": "Error during cooldown check: {{error}}"
  },
  "success": {
    "created": "Submission created successfully."
  },
  "error": {
    "seasonRestriction": "Submission not allowed due to season restrictions.",
    "cooldownActive": "You can only submit one video per hour. Next submission available in: {{hours}}h {{minutes}}m",
    "creationFailed": "Error occurred during submission creation: {{error}}"
  }
}
```

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®å¯¾å¿œ

#### useSubmissionCooldown hook
- `useTranslation`ãƒ•ãƒƒã‚¯ã‚’è¿½åŠ 
- `message_key`ã¨`message_params`ã‚’ä½¿ç”¨ã—ãŸç¿»è¨³å‡¦ç†ã‚’å®Ÿè£…
- ãƒ¬ã‚¬ã‚·ãƒ¼ã‚µãƒãƒ¼ãƒˆï¼ˆæ—¢å­˜ã®`message`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ã‚‚ç¶­æŒ

```typescript
// ç¿»è¨³ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ
let translatedMessage = '';
if (cooldownInfo.message_key && cooldownInfo.message_params) {
  translatedMessage = t(cooldownInfo.message_key, cooldownInfo.message_params);
} else if (cooldownInfo.message) {
  // ãƒ¬ã‚¬ã‚·ãƒ¼ã‚µãƒãƒ¼ãƒˆ
  translatedMessage = cooldownInfo.message;
}
```

## ğŸš€ é©ç”¨ç’°å¢ƒ

- âœ… **é–‹ç™ºç’°å¢ƒ** (`wdttluticnlqzmqmfvgt`): é©ç”¨å®Œäº†
- âœ… **æœ¬ç•ªç’°å¢ƒ** (`qgqcjtjxaoplhxurbpis`): é©ç”¨å®Œäº†

## ğŸ§ª ãƒ†ã‚¹ãƒˆçµæœ

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢æ•°ãƒ†ã‚¹ãƒˆ
```sql
SELECT check_submission_cooldown('123e4567-e89b-12d3-a456-426614174000'::uuid);
```

**çµæœ**:
```json
{
  "can_submit": true,
  "last_submission_time": null,
  "hours_since_last": null,
  "cooldown_remaining_minutes": 0,
  "message_key": "submission.cooldown.canSubmit",
  "message_params": {}
}
```

âœ… ç¿»è¨³ã‚­ãƒ¼ãŒæ­£ã—ãè¿”ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

## ğŸ“ ãƒ¡ãƒªãƒƒãƒˆ

1. **å®Œå…¨ãªå¤šè¨€èªå¯¾å¿œ**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢æ•°ã‹ã‚‰è¿”ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚ç¿»è¨³å¯¾è±¡ã«
2. **ä¸€è²«æ€§ã®å‘ä¸Š**: å…¨ã¦ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒç¿»è¨³ã‚·ã‚¹ãƒ†ãƒ ã‚’é€šã˜ã¦è¡¨ç¤º
3. **ä¿å®ˆæ€§ã®å‘ä¸Š**: ç¿»è¨³ã®å¤‰æ›´ãŒãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã§å®Œçµ
4. **ãƒ¬ã‚¬ã‚·ãƒ¼ã‚µãƒãƒ¼ãƒˆ**: æ—¢å­˜ã®ã‚·ã‚¹ãƒ†ãƒ ã¨ã®äº’æ›æ€§ã‚’ç¶­æŒ

## ğŸ”® ä»Šå¾Œã®æ”¹å–„ç‚¹

1. ä»–ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢æ•°ã‚‚åŒæ§˜ã«å¤šè¨€èªåŒ–
2. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è©³ç´°åŒ–
3. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹å®‰å…¨æ€§å‘ä¸Š

## ğŸ”— é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«

- `supabase/migrations/20250725120000_multilingual_submission_functions.sql`
- `src/i18n/locales/ja.json`
- `src/i18n/locales/en.json`
- `src/hooks/useSubmissionCooldown.ts`

---
**å®Ÿè£…è€…**: AI Assistant
**ãƒ¬ãƒ“ãƒ¥ãƒ¼çŠ¶æ³**: æœªãƒ¬ãƒ“ãƒ¥ãƒ¼
**æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®å®Œå…¨ãªå‹•ä½œç¢ºèª
