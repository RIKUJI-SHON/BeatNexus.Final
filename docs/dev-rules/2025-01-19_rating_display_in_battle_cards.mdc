---
description:
globs:
alwaysApply: false
---
# ğŸ† ãƒãƒˆãƒ«ã‚«ãƒ¼ãƒ‰ ãƒ¬ãƒ¼ãƒˆè¡¨ç¤ºå®Ÿè£…ãƒ­ã‚°

## ğŸ“… å®Ÿè£…æ—¥
2025-01-19

## ğŸ¯ æ¦‚è¦
ãƒãƒˆãƒ«ã‚«ãƒ¼ãƒ‰ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®ä¸‹ã«ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ¬ãƒ¼ãƒˆå€¤ã‚’è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã€‚
ãƒ©ãƒ³ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã¨é€£æºã—ã¦è‰²åˆ†ã‘è¡¨ç¤ºã‚’å®Ÿè£…ã€‚

## ğŸ“ æ›´æ–°å±¥æ­´
- **åˆå›å®Ÿè£…**: ãƒ¬ãƒ¼ãƒˆå€¤ï¼‹ãƒ©ãƒ³ã‚¯åè¡¨ç¤º
- **2025-01-19 æ›´æ–°**: ãƒ©ãƒ³ã‚¯åï¼ˆãƒ†ã‚£ã‚¢ï¼‰ã‚’å‰Šé™¤ã€ãƒ¬ãƒ¼ãƒˆå€¤ã®ã¿è¡¨ç¤ºã«å¤‰æ›´
- **2025-01-19 æ›´æ–°**: ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’æ‹¡å¤§ï¼ˆtext-lg â†’ text-xlï¼‰

## ğŸ” å®Ÿè£…å†…å®¹

### âœ… ãƒ¬ãƒ¼ãƒˆæƒ…å ±å–å¾—æ©Ÿèƒ½
**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/components/battle/BattleView.tsx`

#### æ–°è¦è¿½åŠ ã•ã‚ŒãŸimport
```typescript
import { getCurrentRank } from '../../lib/rankUtils';
import { supabase } from '../../lib/supabase';
```

#### ãƒ¬ãƒ¼ãƒˆæƒ…å ±ç®¡ç†state
```typescript
const [playerRatings, setPlayerRatings] = useState<{
  playerA: { rating: number; loading: boolean };
  playerB: { rating: number; loading: boolean };
}>({
  playerA: { rating: 1200, loading: true },
  playerB: { rating: 1200, loading: true }
});
```

#### ãƒ¬ãƒ¼ãƒˆå–å¾—é–¢æ•°
```typescript
const loadPlayerRatings = async () => {
  try {
    // Player Aã®ãƒ¬ãƒ¼ãƒˆå–å¾—
    const { data: playerAData, error: errorA } = await supabase
      .from('profiles')
      .select('rating')
      .eq('id', battle.player1_user_id)
      .single();

    // Player Bã®ãƒ¬ãƒ¼ãƒˆå–å¾—
    const { data: playerBData, error: errorB } = await supabase
      .from('profiles')
      .select('rating')
      .eq('id', battle.player2_user_id)
      .single();

    setPlayerRatings({
      playerA: { 
        rating: playerAData?.rating || 1200, 
        loading: false 
      },
      playerB: { 
        rating: playerBData?.rating || 1200, 
        loading: false 
      }
    });
  } catch (error) {
    // ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤1200ã«è¨­å®š
  }
};
```

### âœ… UIå®Ÿè£…: ãƒ¬ãƒ¼ãƒˆè¡¨ç¤ºã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### SimpleBattleCard ãƒ¬ãƒ¼ãƒˆè¡¨ç¤º
**Player A/Bå…±é€šãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**:
```typescript
{/* Player Rating Display */}
<div className="mb-2 flex items-center justify-center">
  {playerRatings.playerA.loading ? (
    <div className="text-xs text-gray-400">---</div>
  ) : (
    <div 
      className="text-sm font-medium"
      style={{ color: getCurrentRank(playerRatings.playerA.rating).iconColor }}
    >
      {playerRatings.playerA.rating}
    </div>
  )}
</div>
```

#### SpecialBattleCard ãƒ¬ãƒ¼ãƒˆè¡¨ç¤º
**PlayerDisplayã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ‹¡å¼µ**:
```typescript
const PlayerDisplay = ({ 
  // æ—¢å­˜ã®props...
  currentRating,
  ratingLoading
}: {
  // æ—¢å­˜ã®å‹å®šç¾©...
  currentRating: number;
  ratingLoading: boolean;
}) => (
  <div className="text-center">
    {/* ã‚¢ãƒã‚¿ãƒ¼ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å */}
    <h3 className="text-lg font-bold text-white mb-2 truncate">
      {player?.username || t('battleCard.unknownUser')}
    </h3>
    {/* ãƒ¬ãƒ¼ãƒˆè¡¨ç¤º */}
    <div className="mb-2 flex items-center justify-center">
      {ratingLoading ? (
        <div className="text-xs text-gray-400">---</div>
      ) : (
        <div 
          className="text-sm font-medium"
          style={{ color: getCurrentRank(currentRating).iconColor }}
        >
          {currentRating}
        </div>
      )}
    </div>
    {/* æŠ•ç¥¨æ•°ãªã©æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */}
  </div>
);
```

#### Player Aï¼ˆå·¦å´ï¼‰ãƒ¬ãƒ¼ãƒˆè¡¨ç¤º
```typescript
<div className="flex flex-col">
  <div className="text-white font-bold text-lg">
    {battle.contestant_a?.username || 'Player A'}
  </div>
  <div className="flex items-center gap-2">
    {playerRatings.playerA.loading ? (
      <div className="text-sm text-gray-400">èª­ã¿è¾¼ã¿ä¸­...</div>
    ) : (
      <>
        <div 
          className="text-sm font-medium"
          style={{ color: getCurrentRank(playerRatings.playerA.rating).iconColor }}
        >
          {playerRatings.playerA.rating}
        </div>
        <div className="text-xs text-gray-400">
          {getCurrentRank(playerRatings.playerA.rating).displayName}
        </div>
      </>
    )}
  </div>
</div>
```

#### Player Bï¼ˆå³å´ï¼‰ãƒ¬ãƒ¼ãƒˆè¡¨ç¤º
```typescript
<div className="flex flex-col lg:items-end">
  <div className="text-white font-bold text-lg">
    {battle.contestant_b?.username || 'Player B'}
  </div>
  <div className="flex items-center gap-2 lg:flex-row-reverse">
    {playerRatings.playerB.loading ? (
      <div className="text-sm text-gray-400">èª­ã¿è¾¼ã¿ä¸­...</div>
    ) : (
      <>
        <div 
          className="text-sm font-medium"
          style={{ color: getCurrentRank(playerRatings.playerB.rating).iconColor }}
        >
          {playerRatings.playerB.rating}
        </div>
        <div className="text-xs text-gray-400">
          {getCurrentRank(playerRatings.playerB.rating).displayName}
        </div>
      </>
    )}
  </div>
</div>
```

## ğŸ”§ æŠ€è¡“è©³ç´°

### ãƒ©ãƒ³ã‚¯ã‚·ã‚¹ãƒ†ãƒ é€£æº
- **`getCurrentRank()`**: ãƒ¬ãƒ¼ãƒˆå€¤ã‹ã‚‰ãƒ©ãƒ³ã‚¯æƒ…å ±ã‚’å–å¾—
- **ãƒ©ãƒ³ã‚¯è‰²**: `iconColor`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ãƒ¬ãƒ¼ãƒˆå€¤ã«å¿œã˜ãŸè‰²åˆ†ã‘è¡¨ç¤º

### ãƒ©ãƒ³ã‚¯ä¸€è¦§ã¨è‰²åˆ†ã‘
| ãƒ©ãƒ³ã‚¯ | ãƒ¬ãƒ¼ãƒˆç¯„å›² | è‰² |
|--------|-----------|---|
| Unranked | 0-1099 | ã‚°ãƒ¬ãƒ¼ |
| Beginner | 1100-1199 | ã‚°ãƒ¬ãƒ¼ |
| Intermediate | 1200-1299 | ã‚¤ã‚¨ãƒ­ãƒ¼ |
| Advanced | 1300-1399 | ã‚°ãƒªãƒ¼ãƒ³ |
| Expert | 1400-1599 | ãƒ–ãƒ«ãƒ¼ |
| Master | 1600-1799 | ãƒ‘ãƒ¼ãƒ—ãƒ« |
| Grandmaster | 1800+ | ãƒ”ãƒ³ã‚¯ |

### ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
- **ãƒ¢ãƒã‚¤ãƒ«**: å·¦å³å¯¾ç§°ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- **ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—**: Player Bå³å¯„ã›ï¼ˆ`lg:items-end`, `lg:flex-row-reverse`ï¼‰

### ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- **èª­ã¿è¾¼ã¿ä¸­**: "èª­ã¿è¾¼ã¿ä¸­..."è¡¨ç¤º
- **å–å¾—å¤±æ•—**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤1200ã«è¨­å®š
- **consoleè­¦å‘Š**: ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›

## ğŸ¯ è§£æ±ºã•ã‚ŒãŸå•é¡Œ
1. **ãƒ¬ãƒ¼ãƒˆå¯è¦–åŒ–**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å®ŸåŠ›ãŒä¸€ç›®ã§åˆ†ã‹ã‚‹
2. **ãƒãƒƒãƒãƒ³ã‚°å…¬å¹³æ€§**: ãƒ¬ãƒ¼ãƒˆå·®ã«ã‚ˆã‚‹å®ŸåŠ›å·®ã®èªè­˜å‘ä¸Š
3. **ç«¶æŠ€æ€§å‘ä¸Š**: ãƒ©ãƒ³ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã¨ã®é€£æºã§é”æˆæ„Ÿã‚’ä¿ƒé€²
4. **è¦–è¦šçš„æƒ…å ±**: è‰²åˆ†ã‘ã§ãƒ©ãƒ³ã‚¯ãƒ¬ãƒ™ãƒ«ã‚’ç›´æ„Ÿçš„ã«è¡¨ç¤º
5. **ã‚·ãƒ³ãƒ—ãƒ«è¡¨ç¤º**: ãƒ©ãƒ³ã‚¯åã‚’å‰Šé™¤ã—ã¦ãƒ¬ãƒ¼ãƒˆå€¤ã®ã¿ã®ç°¡æ½”ãªè¡¨ç¤º
6. **è¦–èªæ€§å‘ä¸Š**: ãƒ¦ãƒ¼ã‚¶ãƒ¼åã‚’å¤§ããè¡¨ç¤ºã—ã¦å¯èª­æ€§ã‚’æ”¹å–„

## ğŸ“Š å½±éŸ¿ç¯„å›²
- **ãƒãƒˆãƒ«ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸**: ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼æƒ…å ±ã®å……å®Ÿ
- **ãƒãƒˆãƒ«ã‚ºãƒšãƒ¼ã‚¸**: SimpleBattleCard ã¨ SpecialBattleCard ã«ãƒ¬ãƒ¼ãƒˆè¡¨ç¤ºè¿½åŠ 
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“**: ãƒ¬ãƒ¼ãƒˆæƒ…å ±ã«ã‚ˆã‚‹æˆ¦ç•¥çš„æŠ•ç¥¨åˆ¤æ–­
- **ç«¶æŠ€æ€§**: ãƒ©ãƒ³ã‚¯ãƒãƒƒãƒãƒ³ã‚°ã®é€æ˜æ€§å‘ä¸Š

## ğŸš€ ä»Šå¾Œã®æ”¹å–„ææ¡ˆ
1. **ãƒ¬ãƒ¼ãƒˆå¤‰åŒ–è¡¨ç¤º**: ãƒãƒˆãƒ«å¾Œã®ãƒ¬ãƒ¼ãƒˆå¤‰å‹•äºˆæ¸¬
2. **ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—**: ãƒ©ãƒ³ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã®è©³ç´°èª¬æ˜
3. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: ãƒ¬ãƒ¼ãƒˆæƒ…å ±ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥åŒ–
4. **ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒ¬ãƒ¼ãƒˆè¡¨ç¤ºã®ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³åŠ¹æœ

## âœ… æ¤œè¨¼é …ç›®
- [x] ãƒ¬ãƒ¼ãƒˆå€¤ã®æ­£å¸¸è¡¨ç¤º
- [x] ãƒ©ãƒ³ã‚¯è‰²ã®é©åˆ‡ãªè¡¨ç¤º
- [x] èª­ã¿è¾¼ã¿çŠ¶æ…‹ã®è¡¨ç¤º
- [x] ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
- [ ] å¤šæ§˜ãªãƒ¬ãƒ¼ãƒˆå€¤ã§ã®è¡¨ç¤ºç¢ºèª

## ğŸ”— é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»æŠ€è¡“
- `src/components/battle/BattleView.tsx` - ãƒãƒˆãƒ«ãƒ“ãƒ¥ãƒ¼ãƒšãƒ¼ã‚¸å®Ÿè£…
- `src/components/battle/SimpleBattleCard.tsx` - ã‚·ãƒ³ãƒ—ãƒ«ãƒãƒˆãƒ«ã‚«ãƒ¼ãƒ‰å®Ÿè£…
- `src/components/battle/SpecialBattleCard.tsx` - ã‚¹ãƒšã‚·ãƒ£ãƒ«ãƒãƒˆãƒ«ã‚«ãƒ¼ãƒ‰å®Ÿè£…
- `src/lib/rankUtils.ts` - ãƒ©ãƒ³ã‚¯ã‚·ã‚¹ãƒ†ãƒ 
- `src/lib/supabase.ts` - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
- Supabase `profiles` ãƒ†ãƒ¼ãƒ–ãƒ« - ãƒ¬ãƒ¼ãƒˆæƒ…å ±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

---
**å®Ÿè£…è€…**: AI Assistant  
**ãƒ¬ãƒ“ãƒ¥ãƒ¼**: è¦ãƒ¬ãƒ“ãƒ¥ãƒ¼  
**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: å®Ÿè£…å®Œäº†ã€å‹•ä½œç¢ºèªå¾…ã¡
