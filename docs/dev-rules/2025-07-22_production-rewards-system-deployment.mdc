# æœ¬ç•ªç’°å¢ƒå ±é…¬ã‚·ã‚¹ãƒ†ãƒ å®Ÿè£…ãƒ­ã‚°

## å®Ÿè£…æ—¥
2025-07-22

## æ¦‚è¦
é–‹ç™ºç’°å¢ƒã®å ±é…¬ã‚·ã‚¹ãƒ†ãƒ ï¼ˆBadgeCard UIæ”¹å–„ãƒ»å¤šè¨€èªåŒ–ï¼‰ã‚’æœ¬ç•ªç’°å¢ƒã«å®Œå…¨åŒæœŸã•ã›ã‚‹ä½œæ¥­

## å®Ÿè£…å†…å®¹

### 1. æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ åŒæœŸ
- **rewards**ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆï¼ˆbadgeã®ã¿ã€frameæ©Ÿèƒ½é™¤å¤–ï¼‰
- **user_rewards**ãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å ±é…¬æ‰€æœ‰æ¨©ç®¡ç†ï¼‰
- é©åˆ‡ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã€RLSã€å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®è¨­å®š

### 2. é©ç”¨ã•ã‚ŒãŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
1. **create_season_rewards_system** - åŸºæœ¬çš„ãªå ±é…¬ã‚·ã‚¹ãƒ†ãƒ ä½œæˆ
2. **add_is_active_to_rewards** - is_activeã‚«ãƒ©ãƒ è¿½åŠ 
3. **insert_sample_rewards_data_badges_only** - ã‚µãƒ³ãƒ—ãƒ«ãƒãƒƒã‚¸ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥
4. **remove_frame_functionality_production** - ãƒ•ãƒ¬ãƒ¼ãƒ æ©Ÿèƒ½ã®å®Œå…¨é™¤å»

### 3. ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
æœ¬ç•ªç’°å¢ƒã«ä»¥ä¸‹ã®ãƒãƒƒã‚¸ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸï¼š
- Ultimate Championï¼ˆæœ€é«˜ãƒ©ãƒ³ã‚¯é”æˆï¼‰
- Beat Masterï¼ˆãƒªã‚ºãƒ ã¨ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã®é”äººï¼‰
- Top Performerï¼ˆä¸€è²«ã—ãŸé«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼‰
- Rhythm Kingï¼ˆå„ªã‚ŒãŸãƒªã‚ºãƒ ã‚¹ã‚­ãƒ«ï¼‰
- Rising Starï¼ˆæœ‰æœ›ãªæ–°äººï¼‰
- Beat Warriorï¼ˆãƒãƒˆãƒ«å‚åŠ è€…ï¼‰
- First Battleï¼ˆåˆå›ãƒãƒˆãƒ«å®Œäº†ï¼‰
- Participantï¼ˆã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒ¡ãƒ³ãƒãƒ¼ï¼‰

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ç¢ºèª
- **é–‹ç™ºç’°å¢ƒ**: wdttluticnlqzmqmfvgt
- **æœ¬ç•ªç’°å¢ƒ**: qgqcjtjxaoplhxurbpis
- ä¸¡ç’°å¢ƒã®ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ãŒå®Œå…¨ä¸€è‡´ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

## ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã®å®Ÿè£…çŠ¶æ³
- BadgeCardã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®UIç°¡ç´ åŒ–ï¼ˆãƒˆãƒ­ãƒ•ã‚£ãƒ¼ãƒãƒ¼ã‚¯ãƒ»ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¿ã‚°å‰Šé™¤ï¼‰
- å¤šè¨€èªåŒ–å¯¾å¿œï¼ˆpremium.badges.detailsç¿»è¨³ã‚­ãƒ¼ï¼‰
- ProfilePageã€MyBattlesPageã®æ–‡å­—åˆ—å¤šè¨€èªåŒ–
- Collection Pageã§ã®å ±é…¬è¡¨ç¤ºæ©Ÿèƒ½

## æŠ€è¡“è©³ç´°

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
```sql
-- rewards ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE rewards (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  description TEXT,
  type TEXT NOT NULL CHECK (type = 'badge'),
  image_url TEXT NOT NULL,
  season_id UUID REFERENCES seasons(id),
  rank_requirement INTEGER,
  min_battles INTEGER DEFAULT 0,
  is_limited BOOLEAN DEFAULT true,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT now(),
  updated_at TIMESTAMPTZ DEFAULT now()
);

-- user_rewards ãƒ†ãƒ¼ãƒ–ãƒ«
CREATE TABLE user_rewards (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL REFERENCES profiles(id),
  reward_id UUID NOT NULL REFERENCES rewards(id),
  earned_at TIMESTAMPTZ DEFAULT now(),
  earned_season_id UUID REFERENCES seasons(id),
  UNIQUE(user_id, reward_id)
);
```

### RLSï¼ˆRow Level Securityï¼‰
- rewards: å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª­ã¿å–ã‚Šå¯èƒ½ï¼ˆis_active=trueã®ã¿ï¼‰
- user_rewards: è‡ªåˆ†ã®å ±é…¬ã®ã¿å‚ç…§å¯èƒ½

## æ¤œè¨¼çµæœ
âœ… æœ¬ç•ªç’°å¢ƒã«rewardsã€user_rewardsãƒ†ãƒ¼ãƒ–ãƒ«ãŒæ­£å¸¸ä½œæˆ
âœ… ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆ8å€‹ã®ãƒãƒƒã‚¸ï¼‰ãŒæ­£å¸¸æŒ¿å…¥
âœ… RLSãƒãƒªã‚·ãƒ¼ãŒé©åˆ‡ã«è¨­å®š
âœ… é–‹ç™ºç’°å¢ƒã¨æœ¬ç•ªç’°å¢ƒã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ãŒå®Œå…¨åŒæœŸ

## ä»Šå¾Œã®æ‹¡å¼µäºˆå®š
- ã‚·ãƒ¼ã‚ºãƒ³çµ‚äº†æ™‚ã®è‡ªå‹•å ±é…¬ä»˜ä¸ã‚·ã‚¹ãƒ†ãƒ 
- ãƒãƒˆãƒ«å®Ÿç¸¾ã«åŸºã¥ãå‹•çš„å ±é…¬ç²å¾—
- ç‰¹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆå ±é…¬ã®è¿½åŠ 

## é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«
- `src/components/rewards/BadgeCard.tsx`
- `src/i18n/locales/ja.json`
- `src/i18n/locales/en.json`
- `src/pages/ProfilePage.tsx`
- `src/pages/MyBattlesPage.tsx`
- `supabase/migrations/20250109000001_create_season_rewards_system.sql`
- `supabase/migrations/20250722000000_add_is_active_to_rewards.sql`
- `supabase/migrations/20250722000001_insert_sample_rewards_data.sql`
- `supabase/migrations/20250722000002_remove_frame_functionality_fixed.sql`

## å®Œäº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
ğŸ‰ **æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†** - é–‹ç™ºç’°å¢ƒã¨å®Œå…¨åŒæœŸæ¸ˆã¿
